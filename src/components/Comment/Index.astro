---
// import Disqus from '@/components/Comment/Disqus.astro'
import Giscus from '@/components/Comment/Giscus.astro'
import Mastodon from '@/components/Comment/Mastodon.astro'
import { themeConfig } from '@/config'

interface Props {
  mastodonStatusId?: string
  mastodonInstance?: string
  mastodonUsername?: string
}

const { mastodonStatusId, mastodonInstance, mastodonUsername } = Astro.props

const { enabled: enableComment } = themeConfig.comment

// Disqus
// const disqusShortname = themeConfig.comment?.disqus?.shortname ?? ''
// const showDisqus = enableComment && Boolean(disqusShortname.trim())

// Giscus
const giscusRepo = themeConfig.comment?.giscus?.repo ?? ''
const showGiscus = enableComment && Boolean(giscusRepo.trim())

// Mastodon
const defaultMastodonInstance = themeConfig.comment?.mastodon?.instanceURL ?? ''
const defaultMastodonUsername = themeConfig.comment?.mastodon?.username ?? ''
const effectiveInstance = mastodonInstance || defaultMastodonInstance
const effectiveUsername = mastodonUsername || defaultMastodonUsername
const showMastodon = enableComment && Boolean(mastodonStatusId?.trim()) && Boolean(effectiveInstance.trim())
---

<!-- {showDisqus && <Disqus />} -->
{showGiscus && <Giscus />}
{showMastodon && <Mastodon statusId={mastodonStatusId!} instanceUrl={effectiveInstance} username={effectiveUsername} />}
